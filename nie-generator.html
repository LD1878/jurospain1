---
layout: default
title: Official NIE Application Generator (Full Spec)
permalink: /tools/nie-generator/
---

<script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>

<style>
    /* JUROSPAIN BRANDING */
    :root {
        --brand-navy: #002868;
        --brand-red: #E30613;
        --brand-gold: #C5A059;
    }

    .tool-container {
        max-width: 900px;
        margin: 4rem auto;
        font-family: 'Inter', sans-serif;
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        overflow: hidden;
        border: 1px solid #e1e4e8;
    }

    .tool-header {
        background: var(--brand-navy);
        color: white;
        padding: 2.5rem 2rem;
        text-align: center;
    }

    .tool-header h1 {
        margin: 0;
        font-family: 'Oswald', sans-serif;
        text-transform: uppercase;
        font-size: 2rem;
    }

    .form-section { padding: 2.5rem; }

    .section-title {
        color: var(--brand-navy);
        font-weight: 800;
        text-transform: uppercase;
        font-size: 0.9rem;
        letter-spacing: 1px;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
        margin-bottom: 20px;
        margin-top: 30px;
    }

    /* GRID SYSTEM */
    .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }

    .full-width { grid-column: span 2; }

    label {
        display: block;
        font-weight: 700;
        font-size: 0.85rem;
        color: #4a5568;
        margin-bottom: 6px;
    }

    input, select {
        width: 100%;
        padding: 12px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        transition: 0.3s;
        background: #fcfcfc;
    }

    input:focus, select:focus {
        border-color: var(--brand-red);
        outline: none;
        background: white;
    }

    .btn-generate {
        background: var(--brand-red);
        color: white;
        font-family: 'Oswald', sans-serif;
        font-size: 1.2rem;
        text-transform: uppercase;
        width: 100%;
        padding: 1.5rem;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 3rem;
        box-shadow: 0 10px 20px rgba(227, 6, 19, 0.2);
    }

    @media(max-width: 700px) {
        .form-grid { grid-template-columns: 1fr; }
        .full-width { grid-column: span 1; }
    }
</style>

<div class="tool-container">
    <div class="tool-header">
        <h1>NIE Application Wizard</h1>
        <p style="color:var(--brand-gold); margin-top:10px;">Complete every field of the EX-15 instantly.</p>
    </div>

    <div class="form-section">
        
        <div class="section-title">1. Applicant Details</div>
        <div class="form-grid">
            <div class="full-width">
                <label>Passport Number</label>
                <input type="text" id="passport">
            </div>
            
            <div>
                <label>First Name</label>
                <input type="text" id="firstname">
            </div>
            
            <div>
                <label>Surname (Last Name)</label>
                <input type="text" id="surname">
            </div>

            <div>
                <label>Gender</label>
                <select id="sex">
                    <option value="H">Male (H)</option>
                    <option value="M">Female (M)</option>
                </select>
            </div>
            
            <div>
                <label>Marital Status</label>
                <select id="civil">
                    <option value="S">Single (S)</option>
                    <option value="C">Married (C)</option>
                    <option value="D">Divorced (D)</option>
                    <option value="V">Widowed (V)</option>
                </select>
            </div>

            <div>
                <label>Date of Birth</label>
                <input type="text" id="dob" placeholder="DD/MM/YYYY">
            </div>

            <div>
                <label>Place of Birth (City)</label>
                <input type="text" id="birthplace">
            </div>

            <div>
                <label>Country of Birth</label>
                <input type="text" id="birthcountry">
            </div>

            <div>
                <label>Nationality</label>
                <input type="text" id="nationality">
            </div>
            
            <div>
                <label>Father's Name</label>
                <input type="text" id="father">
            </div>

            <div>
                <label>Mother's Name</label>
                <input type="text" id="mother">
            </div>
        </div>

        <div class="section-title">2. Contact Address (Spain or Abroad)</div>
        <div class="form-grid">
            <div class="full-width">
                <label>Street Name</label>
                <input type="text" id="street">
            </div>
            
            <div>
                <label>House Number</label>
                <input type="text" id="street_no">
            </div>

            <div>
                <label>Floor/Door (Optional)</label>
                <input type="text" id="floor">
            </div>

            <div>
                <label>City (Localidad)</label>
                <input type="text" id="city">
            </div>

            <div>
                <label>Postal Code</label>
                <input type="text" id="zip">
            </div>

            <div>
                <label>Province</label>
                <input type="text" id="province">
            </div>

            <div>
                <label>Mobile Phone</label>
                <input type="text" id="phone">
            </div>

            <div>
                <label>Email Address</label>
                <input type="email" id="email">
            </div>
        </div>

        <div class="section-title">3. Application Data</div>
        <div class="full-width">
            <label>Reason for Application</label>
            <select id="reason">
                <option value="house">Buying Property (Compra de Inmueble)</option>
                <option value="bank">Opening Bank Account (Apertura Cuenta)</option>
                <option value="company">Setting up Company (Constitución Sociedad)</option>
                <option value="taxes">Tax Purposes (Intereses Económicos)</option>
                <option value="other">Other Economic Interest</option>
            </select>
        </div>
        
        <div class="form-grid" style="margin-top: 20px;">
             <div>
                <label>Signing Place (City)</label>
                <input type="text" id="sign_city" placeholder="e.g. London or Madrid">
            </div>
             <div>
                <label>Signing Date</label>
                <input type="text" id="sign_date" placeholder="DD/MM/YYYY">
            </div>
        </div>

        <button class="btn-generate" onclick="generatePDF()">Download Complete PDF</button>

    </div>
</div>

<script>
    const { PDFDocument } = PDFLib;

    async function generatePDF() {
        const btn = document.querySelector('.btn-generate');
        btn.innerText = "Processing...";
        
        try {
            const url = '/assets/pdf/ex15.pdf'; 
            const existingPdfBytes = await fetch(url).then(res => res.arrayBuffer());
            const pdfDoc = await PDFDocument.load(existingPdfBytes);
            const form = pdfDoc.getForm();

            // 1. GATHER DATA
            const d = {
                passport: document.getElementById('passport').value.toUpperCase(),
                name: document.getElementById('firstname').value.toUpperCase(),
                surname: document.getElementById('surname').value.toUpperCase(),
                sex: document.getElementById('sex').value,
                civil: document.getElementById('civil').value,
                dob: document.getElementById('dob').value,
                birthplace: document.getElementById('birthplace').value.toUpperCase(),
                birthcountry: document.getElementById('birthcountry').value.toUpperCase(),
                nationality: document.getElementById('nationality').value.toUpperCase(),
                father: document.getElementById('father').value.toUpperCase(),
                mother: document.getElementById('mother').value.toUpperCase(),
                
                street: document.getElementById('street').value.toUpperCase(),
                no: document.getElementById('street_no').value.toUpperCase(),
                floor: document.getElementById('floor').value.toUpperCase(),
                city: document.getElementById('city').value.toUpperCase(),
                zip: document.getElementById('zip').value,
                province: document.getElementById('province').value.toUpperCase(),
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value.toLowerCase(),
                
                reason: document.getElementById('reason').value,
                sign_city: document.getElementById('sign_city').value.toUpperCase(),
                sign_date: document.getElementById('sign_date').value
            };

            // 2. FILL FIELDS (Using EXACT names you provided)
            
            // --- PERSONAL ---
            form.getTextField('Pasaporte').setText(d.passport);
            form.getTextField('Nombre_Extranjero').setText(d.name);
            form.getTextField('Apellido1_extranjero').setText(d.surname);
            form.getTextField('Sexo').setText(d.sex);
            form.getTextField('Estado_Civil').setText(d.civil);
            form.getTextField('FechaNacimiento_Extranjero').setText(d.dob);
            form.getTextField('Lugar_Extranjero').setText(d.birthplace);
            form.getTextField('Pais_Extranjero').setText(d.birthcountry);
            form.getTextField('Nacionalidad_Extranjero').setText(d.nationality);
            form.getTextField('NombrePadre_Extranjero').setText(d.father);
            form.getTextField('NombreMadre_Extranjero').setText(d.mother);

            // --- ADDRESS ---
            form.getTextField('Domicilio_Extranjero').setText(d.street);
            form.getTextField('Numero_Extranjero').setText(d.no);
            form.getTextField('Piso_Extranjero').setText(d.floor);
            form.getTextField('Localidad_Extranjero').setText(d.city);
            form.getTextField('CodigoPostal_Extranjero').setText(d.zip);
            form.getTextField('Provincia_Extranjero').setText(d.province);
            form.getTextField('TelefonoMovil_Extranjero').setText(d.phone);
            form.getTextField('Email_Extranjero').setText(d.email);

            // --- REASON (SECTION 4) ---
            const reasonMap = {
                'house': 'COMPRA DE INMUEBLE',
                'bank': 'APERTURA CUENTA BANCARIA',
                'company': 'CONSTITUCION SOCIEDAD',
                'taxes': 'INTERESES ECONOMICOS',
                'other': 'INTERESES ECONOMICOS'
            };
            form.getTextField('MotivosEspecificar').setText(reasonMap[d.reason]);
            
            // Tick "Economic Interests" Box
            // Note: Radio buttons for "Motivos" are tricky. We try setting it to "Intereses Económicos"
            // If this line fails in your specific PDF, comment it out and let them tick it manually.
            try { form.getRadioGroup('Motivos').select('Intereses Económicos'); } catch(e){} 
            try { form.getCheckBox('Motivos').check(); } catch(e){}

            // --- SIGNING BLOCK (SECTION 5) ---
            // If your PDF has these fields:
            try { form.getTextField('FirmaLocalidad').setText(d.sign_city); } catch(e){}
            
            // Date Parsing (DD / MM / YYYY)
            if(d.sign_date.includes('/')) {
                const parts = d.sign_date.split('/');
                try { form.getTextField('Firma_dia').setText(parts[0]); } catch(e){}
                try { form.getTextField('Firma_Mes').setText(parts[1]); } catch(e){}
                try { form.getTextField('Firma_Anio').setText(parts[2]); } catch(e){}
            }

            // 3. DOWNLOAD
            const pdfBytes = await pdfDoc.save();
            download(pdfBytes, "EX15_Complete_JuroSpain.pdf");
            btn.innerText = "✅ Generated!";

        } catch (err) {
            console.error(err);
            alert("Error: Check console for details. Ensure field names match PDF exactly.");
            btn.innerText = "Error - Try Again";
        }
    }

    function download(data, filename) {
        var blob = new Blob([data], {type: "application/pdf"});
        var link = document.createElement('a');
        link.href = window.URL.createObjectURL(blob);
        link.download = filename;
        link.click();
    }
</script>
