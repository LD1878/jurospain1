---
layout: default
title: Free NIE Application Generator (Instant Download)
permalink: /tools/nie-generator/
---

<script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>

<style>
    .nie-generator-wrapper {
        max-width: 800px;
        margin: 4rem auto;
        font-family: 'Inter', sans-serif;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.08);
        overflow: hidden;
    }

    .header-banner {
        background: #002868; /* Navy */
        color: white;
        padding: 2rem;
        text-align: center;
    }

    .form-body {
        padding: 2rem;
    }

    .input-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }

    .full-width { grid-column: span 2; }

    label {
        font-weight: 700;
        font-size: 0.9rem;
        color: #444;
        display: block;
        margin-bottom: 5px;
    }

    input, select {
        width: 100%;
        padding: 12px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
    }

    .legal-tip {
        background: #fff8e1;
        border-left: 4px solid #ffc107;
        padding: 10px;
        font-size: 0.85rem;
        color: #664d03;
        margin-top: 5px;
    }

    .btn-generate {
        background: #E30613; /* Red */
        color: white;
        font-weight: 800;
        text-transform: uppercase;
        width: 100%;
        padding: 1.2rem;
        border: none;
        border-radius: 50px;
        font-size: 1.1rem;
        cursor: pointer;
        margin-top: 2rem;
        transition: 0.3s;
    }

    .btn-generate:hover { background: #b9050f; }

    /* DIAGNOSTIC PANEL (Hidden by default) */
    #diagnostic {
        display: none; 
        background: #333; 
        color: #0f0; 
        padding: 20px; 
        margin-top: 50px;
        font-family: monospace;
    }
</style>

<div class="nie-generator-wrapper">
    <div class="header-banner">
        <h1 style="margin:0; font-family:'Oswald';">NIE Application Wizard</h1>
        <p style="opacity:0.8;">Fill in English. Download the official Spanish EX-15.</p>
    </div>

    <div class="form-body">
        
        <h3 style="color: #002868; border-bottom: 1px solid #eee; padding-bottom: 10px;">1. Applicant Details</h3>
        <div class="input-grid">
            <div>
                <label>Passport Number</label>
                <input type="text" id="passport">
            </div>
            <div>
                <label>Nationality</label>
                <input type="text" id="nationality" placeholder="e.g. BRITISH">
            </div>
            <div>
                <label>Surname (Last Name)</label>
                <input type="text" id="surname">
                <div class="legal-tip">Exactly as it appears on your passport.</div>
            </div>
            <div>
                <label>First Name</label>
                <input type="text" id="firstname">
            </div>
            <div>
                <label>Father's First Name</label>
                <input type="text" id="father">
            </div>
            <div>
                <label>Mother's First Name</label>
                <input type="text" id="mother">
            </div>
        </div>

        <h3 style="color: #002868; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-top: 30px;">2. Reason for NIE</h3>
        <div class="full-width">
            <label>Why do you need a NIE?</label>
            <select id="reason">
                <option value="house">Buying Property (Compra de Inmueble)</option>
                <option value="bank">Opening Bank Account (Apertura Cuenta)</option>
                <option value="company">Setting up Company (Constituci√≥n Sociedad)</option>
                <option value="other">Other Economic Interest</option>
            </select>
            <div class="legal-tip">We automatically select "Economic Interests" and write the Spanish legal term for you.</div>
        </div>

        <button class="btn-generate" onclick="generatePDF()">Download Official PDF</button>
        
        <p style="text-align:center; margin-top:10px; font-size:0.9rem; color:#888;">
            100% Private. Data is processed in your browser.
        </p>

        <div style="text-align:center; margin-top: 30px;">
            <a href="#" onclick="document.getElementById('diagnostic').style.display='block'; return false;" style="color:#ddd; font-size:10px;">Admin: Check PDF Fields</a>
        </div>
    </div>

    <div id="diagnostic">
        <strong>PDF Field Names Found:</strong>
        <ul id="field-list"></ul>
    </div>
</div>

<script>
    const { PDFDocument } = PDFLib;

    async function generatePDF() {
        const btn = document.querySelector('.btn-generate');
        btn.innerText = "Processing...";

        try {
            // 1. LOAD THE PDF
            // Ensure this file exists!
            const url = '/assets/pdf/ex15.pdf'; 
            const existingPdfBytes = await fetch(url).then(res => res.arrayBuffer());

            // 2. PARSE THE FORM
            const pdfDoc = await PDFDocument.load(existingPdfBytes);
            const form = pdfDoc.getForm();

            // 3. GET USER INPUTS
            const data = {
                passport: document.getElementById('passport').value.toUpperCase(),
                surname: document.getElementById('surname').value.toUpperCase(),
                firstname: document.getElementById('firstname').value.toUpperCase(),
                father: document.getElementById('father').value.toUpperCase(),
                mother: document.getElementById('mother').value.toUpperCase(),
                nationality: document.getElementById('nationality').value.toUpperCase(),
                reason: document.getElementById('reason').value
            };

            // 4. FILL THE FIELDS (SMART MAPPING)
            // Note: These names ('apellidos', 'nombre', etc.) MUST match your PDF.
            // Use the "Admin" link at the bottom to see your specific PDF's field names if this fails.
            
            try { form.getTextField('Pasaporte').setText(data.passport); } catch(e){}
            try { form.getTextField('Apellidos').setText(data.surname); } catch(e){}
            try { form.getTextField('Nombre').setText(data.firstname); } catch(e){}
            try { form.getTextField('Nombre de padre').setText(data.father); } catch(e){}
            try { form.getTextField('Nombre de madre').setText(data.mother); } catch(e){}
            try { form.getTextField('Nacionalidad').setText(data.nationality); } catch(e){}
            
            // 5. SMART LOGIC (The "200 IQ" part)
            // Automatically Check "Economic Interests"
            try { form.getCheckBox('Intereses Economicos').check(); } catch(e){} 
            
            // Write the Spanish Legal Reason
            const reasonMap = {
                'house': 'COMPRA DE INMUEBLE',
                'bank': 'APERTURA CUENTA BANCARIA',
                'company': 'CONSTITUCION SOCIEDAD',
                'other': 'INTERESES ECONOMICOS'
            };
            try { form.getTextField('Especificar Motivos').setText(reasonMap[data.reason]); } catch(e){}

            // 6. DOWNLOAD
            const pdfBytes = await pdfDoc.save();
            download(pdfBytes, "NIE_Application_JuroSpain.pdf");
            btn.innerText = "Download Again";

        } catch (err) {
            console.error(err);
            alert("Error: Could not load PDF. Check the Console (F12) or click 'Admin' to debug.");
        }
    }

    // DIAGNOSTIC TOOL (Helps you find the names)
    document.querySelector('.btn-generate').addEventListener('mouseover', async () => {
        const url = '/assets/pdf/ex15.pdf';
        const existingPdfBytes = await fetch(url).then(res => res.arrayBuffer());
        const pdfDoc = await PDFDocument.load(existingPdfBytes);
        const form = pdfDoc.getForm();
        const fields = form.getFields();
        const list = document.getElementById('field-list');
        list.innerHTML = '';
        fields.forEach(f => {
            const li = document.createElement('li');
            li.textContent = f.getName() + " (" + f.constructor.name + ")";
            list.appendChild(li);
        });
    });

    function download(data, filename) {
        var blob = new Blob([data], {type: "application/pdf"});
        var link = document.createElement('a');
        link.href = window.URL.createObjectURL(blob);
        link.download = filename;
        link.click();
    }
</script>
