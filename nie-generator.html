---
layout: default
title: Official NIE Application Generator
permalink: /tools/nie-generator/
---

<script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>

<style>
    /* JUROSPAIN BRANDING COLORS */
    :root {
        --brand-navy: #002868;
        --brand-red: #E30613;
        --brand-gold: #C5A059;
        --bg-gray: #f4f6f8;
    }

    .tool-container {
        max-width: 900px;
        margin: 4rem auto;
        font-family: 'Inter', sans-serif;
        background: white;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        overflow: hidden;
        border: 1px solid #e1e4e8;
    }

    .tool-header {
        background: var(--brand-navy);
        color: white;
        padding: 2.5rem 2rem;
        text-align: center;
        position: relative;
    }

    .tool-header h1 {
        margin: 0;
        font-family: 'Oswald', sans-serif;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 2rem;
    }

    .tool-header p {
        color: var(--brand-gold);
        font-weight: 600;
        margin-top: 10px;
        opacity: 0.9;
    }

    .form-section {
        padding: 2.5rem;
    }

    .section-title {
        color: var(--brand-navy);
        font-weight: 800;
        text-transform: uppercase;
        font-size: 0.9rem;
        letter-spacing: 1px;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
        margin-bottom: 20px;
        margin-top: 30px;
    }

    .section-title:first-child { margin-top: 0; }

    /* GRID SYSTEM */
    .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr; /* 2 Columns */
        gap: 20px;
    }

    .full-width { grid-column: span 2; }
    .three-quarters { grid-column: span 2; } /* On mobile resets */

    label {
        display: block;
        font-weight: 700;
        font-size: 0.85rem;
        color: #4a5568;
        margin-bottom: 6px;
    }

    input, select {
        width: 100%;
        padding: 12px;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        transition: 0.3s;
        background: #fcfcfc;
    }

    input:focus, select:focus {
        border-color: var(--brand-red);
        outline: none;
        background: white;
        box-shadow: 0 0 0 3px rgba(227, 6, 19, 0.1);
    }

    /* THE MAGIC BUTTON */
    .btn-generate {
        background: var(--brand-red);
        color: white;
        font-family: 'Oswald', sans-serif;
        font-size: 1.2rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        width: 100%;
        padding: 1.5rem;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 3rem;
        transition: transform 0.2s, box-shadow 0.2s;
        box-shadow: 0 10px 20px rgba(227, 6, 19, 0.2);
    }

    .btn-generate:hover {
        transform: translateY(-2px);
        box-shadow: 0 15px 30px rgba(227, 6, 19, 0.3);
    }

    .trust-badge {
        text-align: center;
        margin-top: 1.5rem;
        font-size: 0.85rem;
        color: #718096;
        display: flex;
        justify-content: center;
        gap: 20px;
    }

    /* Mobile Responsive */
    @media(max-width: 700px) {
        .form-grid { grid-template-columns: 1fr; }
        .full-width { grid-column: span 1; }
    }
</style>

<div class="tool-container">
    <div class="tool-header">
        <h1>NIE Application Wizard</h1>
        <p>Convert your English details into the Official EX-15 Form</p>
    </div>

    <div class="form-section">
        
        <div class="section-title">1. Applicant Details</div>
        <div class="form-grid">
            <div class="full-width">
                <label>Passport Number</label>
                <input type="text" id="passport" placeholder="Your Passport No.">
            </div>
            
            <div>
                <label>First Name</label>
                <input type="text" id="firstname" placeholder="e.g. John">
            </div>
            
            <div>
                <label>Surname (Last Name)</label>
                <input type="text" id="surname" placeholder="e.g. Smith">
            </div>

            <div>
                <label>Father's First Name</label>
                <input type="text" id="father" placeholder="Required in Spain">
            </div>

            <div>
                <label>Mother's First Name</label>
                <input type="text" id="mother" placeholder="Required in Spain">
            </div>

            <div>
                <label>Date of Birth</label>
                <input type="text" id="dob" placeholder="DD/MM/YYYY">
            </div>

            <div>
                <label>Nationality</label>
                <input type="text" id="nationality" placeholder="e.g. British">
            </div>
            
            <div>
                <label>Sex</label>
                <select id="sex">
                    <option value="H">Male (Hombre)</option>
                    <option value="M">Female (Mujer)</option>
                </select>
            </div>
            
            <div>
                <label>Marital Status</label>
                <select id="civil">
                    <option value="S">Single (Soltero)</option>
                    <option value="C">Married (Casado)</option>
                    <option value="D">Divorced (Divorciado)</option>
                </select>
            </div>
        </div>

        <div class="section-title">2. Address (Spain or Abroad)</div>
        <div class="form-grid">
            <div class="full-width">
                <label>Street Name</label>
                <input type="text" id="street" placeholder="e.g. Calle Gran Via">
            </div>
            
            <div>
                <label>House Number</label>
                <input type="text" id="street_no">
            </div>

            <div>
                <label>Floor/Door (Optional)</label>
                <input type="text" id="floor">
            </div>

            <div>
                <label>City (Localidad)</label>
                <input type="text" id="city">
            </div>

            <div>
                <label>Postal Code</label>
                <input type="text" id="zip">
            </div>

            <div>
                <label>Province / Region</label>
                <input type="text" id="province">
            </div>

            <div class="full-width">
                <label>Email Address</label>
                <input type="email" id="email">
            </div>
        </div>

        <div class="section-title">3. Application Reason</div>
        <div class="full-width">
            <label>Why do you need the NIE?</label>
            <select id="reason">
                <option value="house">Buying Property (Compra de Inmueble)</option>
                <option value="bank">Opening Bank Account (Apertura Cuenta)</option>
                <option value="company">Setting up Company (ConstituciÃ³n Sociedad)</option>
                <option value="taxes">Tax Purposes (Intereses EconÃ³micos)</option>
            </select>
            <div style="margin-top:8px; font-size:0.85rem; color:#666; background:#fff3cd; padding:10px; border-radius:4px;">
                ðŸ’¡ <strong>JuroSpain Tip:</strong> We automatically select "Economic Interests" for you, as this is the standard category for investors and property buyers.
            </div>
        </div>

        <button class="btn-generate" onclick="generatePDF()">Download Official PDF</button>

        <div class="trust-badge">
            <span>ðŸ”’ Secure Processing</span>
            <span>ðŸ‡ªðŸ‡¸ 2026 Compliant</span>
            <span>âš¡ Instant Download</span>
        </div>
    </div>
</div>

<script>
    const { PDFDocument } = PDFLib;

    async function generatePDF() {
        const btn = document.querySelector('.btn-generate');
        const originalText = btn.innerText;
        btn.innerText = "Generating...";
        
        try {
            // 1. LOAD YOUR PDF
            const url = '/assets/pdf/ex15.pdf'; // Ensure this matches your file path
            const existingPdfBytes = await fetch(url).then(res => res.arrayBuffer());

            // 2. LOAD DOCUMENT
            const pdfDoc = await PDFDocument.load(existingPdfBytes);
            const form = pdfDoc.getForm();

            // 3. GET DATA FROM INPUTS
            const d = {
                passport: document.getElementById('passport').value.toUpperCase(),
                name: document.getElementById('firstname').value.toUpperCase(),
                surname: document.getElementById('surname').value.toUpperCase(),
                father: document.getElementById('father').value.toUpperCase(),
                mother: document.getElementById('mother').value.toUpperCase(),
                dob: document.getElementById('dob').value,
                nationality: document.getElementById('nationality').value.toUpperCase(),
                sex: document.getElementById('sex').value,
                civil: document.getElementById('civil').value,
                
                street: document.getElementById('street').value.toUpperCase(),
                no: document.getElementById('street_no').value.toUpperCase(),
                floor: document.getElementById('floor').value.toUpperCase(),
                city: document.getElementById('city').value.toUpperCase(),
                zip: document.getElementById('zip').value,
                province: document.getElementById('province').value.toUpperCase(),
                email: document.getElementById('email').value.toLowerCase(),
                
                reason: document.getElementById('reason').value
            };

            // 4. MAP TO PDF FIELDS (Using the names you found!)
            
            // --- Personal Details ---
            try { form.getTextField('Pasaporte').setText(d.passport); } catch(e){}
            try { form.getTextField('Nombre_Extranjero').setText(d.name); } catch(e){}
            try { form.getTextField('Apellido1_extranjero').setText(d.surname); } catch(e){}
            // Note: Leaving Apellido2 blank as typical for Anglo names
            
            try { form.getTextField('NombrePadre_Extranjero').setText(d.father); } catch(e){}
            try { form.getTextField('NombreMadre_Extranjero').setText(d.mother); } catch(e){}
            try { form.getTextField('FechaNacimiento_Extranjero').setText(d.dob); } catch(e){}
            try { form.getTextField('Nacionalidad_Extranjero').setText(d.nationality); } catch(e){}
            try { form.getTextField('Sexo').setText(d.sex); } catch(e){}
            try { form.getTextField('Estado_Civil').setText(d.civil); } catch(e){}

            // --- Address ---
            try { form.getTextField('Domicilio_Extranjero').setText(d.street); } catch(e){}
            try { form.getTextField('Numero_Extranjero').setText(d.no); } catch(e){}
            try { form.getTextField('Piso_Extranjero').setText(d.floor); } catch(e){}
            try { form.getTextField('Localidad_Extranjero').setText(d.city); } catch(e){}
            try { form.getTextField('CodigoPostal_Extranjero').setText(d.zip); } catch(e){}
            try { form.getTextField('Provincia_Extranjero').setText(d.province); } catch(e){}
            try { form.getTextField('Email_Extranjero').setText(d.email); } catch(e){}

            // --- THE STRATEGY LOGIC ---
            
            // A. Select "NIE" (TipoDocumento)
            // Note: Radio buttons are tricky without knowing the exact export value.
            // We try the common ones ('NIE', '1', 'Yes'). If fails, user can tick manually.
            try { 
                const docGroup = form.getRadioGroup('TipoDocumento');
                docGroup.select('NIE'); // Common value
            } catch(e) {
                // Fallback if it's a checkbox
                 try { form.getCheckBox('TipoDocumento').check(); } catch(e){}
            }

            // B. Select "Economic" (Motivos)
            try { 
                const motGroup = form.getRadioGroup('Motivos');
                motGroup.select('E'); // 'E' is common for Economico, or 'Intereses Economicos'
            } catch(e) {}

            // C. WRITE THE REASON TEXT (This is the most important part)
            const reasonMap = {
                'house': 'COMPRA DE INMUEBLE',
                'bank': 'APERTURA CUENTA BANCARIA',
                'company': 'CONSTITUCION SOCIEDAD',
                'taxes': 'INTERESES ECONOMICOS'
            };
            try { 
                form.getTextField('MotivosEspecificar').setText(reasonMap[d.reason]); 
            } catch(e) {
                console.log("Could not find MotivosEspecificar field");
            }

            // 5. SAVE & DOWNLOAD
            const pdfBytes = await pdfDoc.save();
            download(pdfBytes, "EX15_JuroSpain_AutoFilled.pdf");
            
            btn.innerText = "âœ… Generated! Check Downloads";
            setTimeout(() => btn.innerText = originalText, 4000);

        } catch (err) {
            console.error(err);
            alert("Error generating PDF. Please ensure /assets/pdf/ex15.pdf exists.");
            btn.innerText = "Error - Try Again";
        }
    }

    function download(data, filename) {
        var blob = new Blob([data], {type: "application/pdf"});
        var link = document.createElement('a');
        link.href = window.URL.createObjectURL(blob);
        link.download = filename;
        link.click();
    }
</script>
