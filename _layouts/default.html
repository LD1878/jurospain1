<script>
        const THEMES = [
            { // Theme 1: Spain-light (Original Light)
                name: 'spain-light',
                '--bg-primary': '#fff8f0',
                '--bg-secondary': '#ffffff',
                '--text-primary': '#333',
                '--text-muted': '#8b8b85',
                '--border-light': 'rgba(124, 31, 31, 0.06)',
                '--btn-text': '#ffffff',
                '--gold-color': 'var(--sp-gold)'
            },
            { // Theme 2: Deep-Dark (Plain Dark Mode - KEPT)
                name: 'deep-dark',
                '--bg-primary': '#121212',
                '--bg-secondary': '#1f1f1f',
                '--text-primary': '#e0e0e0',
                '--text-muted': '#a0a0a0',
                '--border-light': 'rgba(255, 215, 0, 0.15)',
                '--btn-text': 'var(--text-primary)',
                '--gold-color': 'var(--sp-gold)'
            },
            { // Theme 3: Vibrant Synth (NEW Colorful Dark Mode)
                name: 'vibrant-synth',
                '--bg-primary': '#1a0736',      // Deep Indigo/Violet
                '--bg-secondary': '#300f5c',   // Darker Purple
                '--text-primary': '#fff0ff',   // Soft White/Pink Text
                '--text-muted': '#a668ff',     // Vibrant Lavender
                '--border-light': '#ff66b2',   // Bright Magenta/Pink Border
                '--btn-text': '#1a0736',       // Text to contrast with red button
                '--gold-color': '#39FF14'      // Neon Green Accent
            },
            { // Theme 4: Retro-Sunset (KEPT)
                name: 'retro-sunset',
                '--bg-primary': '#2a0230',
                '--bg-secondary': '#4d194d',
                '--text-primary': '#ffc596', 
                '--text-muted': '#e684ae',
                '--border-light': '#ffc596', 
                '--btn-text': '#2a0230',
                '--gold-color': '#FF8000'
            }
        ];

        function applyTheme(themeName) {
            const root = document.documentElement;
            const theme = THEMES.find(t => t.name === themeName);
            if (!theme) {
                // If theme is not found, we stop here, but the FOUC script below handles this case now.
                return; 
            }

            // Apply all theme variables to the HTML element's style
            for (const [key, value] of Object.entries(theme)) {
                if (key !== 'name') {
                    root.style.setProperty(key, value);
                }
            }
            localStorage.setItem('theme-name', themeName);
            root.setAttribute('data-theme', themeName);
        }

        // FOUC Prevention Script: Load stored theme or default
        (function() {
            let currentThemeName = localStorage.getItem('theme-name');
            const defaultThemeName = THEMES[0].name; // 'spain-light'

            // Check if the stored theme name is valid in the current THEMES array
            if (!THEMES.some(t => t.name === currentThemeName)) {
                // If it's invalid (e.g., old 'cyber-neon'), reset to the default theme.
                currentThemeName = defaultThemeName;
                localStorage.setItem('theme-name', defaultThemeName);
            }
            
            // Apply the valid theme
            applyTheme(currentThemeName);
        })();
    </script>
    
    {% seo %}
</head>
